/*
Copyright 2024 Tomoaki Itoh
This software is released under the MIT License, see LICENSE.txt.
//*/

#include "LCWReverbParam.h"

const int32_t lcwCombDelaySize[LCW_REVERB_COMB_MAX] = {
    1447, 1511, 1567, 1627, 1693, 1759, 1831, 1907, 1979, 2063, 2143, 2237
};

const float lcwReverbGainTable[LCW_REVERB_GAIN_TABLE_SIZE][LCW_REVERB_COMB_MAX] = {
    { .0f, .0f, .0f, .0f, .0f, .0f, .0f, .0f, .0f, .0f, .0f, .0f }, // [ 0]
// 1447, 1511, 1567, 1627, 1693, 1759, 1831, 1907, 1979, 2063, 2143, 2237
    { 0.907993, 0.904125, 0.900755, 0.897157, 0.893216, 0.889292, 0.885032, 0.880556, 0.876338, 0.871441, 0.866803, 0.861386 }, // [ 1] 2.158
    { 0.914414, 0.910803, 0.907654, 0.904293, 0.900610, 0.896942, 0.892958, 0.888772, 0.884824, 0.880240, 0.875897, 0.870820 }, // [ 2] 2.327
    { 0.920407, 0.917037, 0.914098, 0.910960, 0.907520, 0.904093, 0.900370, 0.896456, 0.892764, 0.888476, 0.884412, 0.879659 }, // [ 3] 2.511
    { 0.925997, 0.922854, 0.920112, 0.917183, 0.913973, 0.910773, 0.907295, 0.903639, 0.900189, 0.896180, 0.892379, 0.887933 }, // [ 4] 2.709
    { 0.931210, 0.928279, 0.925722, 0.922991, 0.919995, 0.917009, 0.913763, 0.910349, 0.907126, 0.903381, 0.899829, 0.895672 }, // [ 5] 2.922
    { 0.936068, 0.933337, 0.930954, 0.928407, 0.925613, 0.922828, 0.919800, 0.916613, 0.913605, 0.910108, 0.906790, 0.902906 }, // [ 6] 3.152
    { 0.940594, 0.938050, 0.935829, 0.933456, 0.930852, 0.928255, 0.925431, 0.922459, 0.919652, 0.916388, 0.913291, 0.909664 }, // [ 7] 3.400
    { 0.944809, 0.942440, 0.940372, 0.938160, 0.935734, 0.933314, 0.930682, 0.927911, 0.925293, 0.922249, 0.919358, 0.915974 }, // [ 8] 3.668
    { 0.948734, 0.946528, 0.944602, 0.942543, 0.940283, 0.938029, 0.935576, 0.932993, 0.930553, 0.927715, 0.925019, 0.921862 }, // [ 9] 3.957
    { 0.952386, 0.950333, 0.948541, 0.946624, 0.944520, 0.942420, 0.940136, 0.937730, 0.935456, 0.932811, 0.930298, 0.927355 }, // [10] 4.269
    { 0.955784, 0.953875, 0.952207, 0.950423, 0.948464, 0.946510, 0.944383, 0.942142, 0.940024, 0.937560, 0.935219, 0.932475 }, // [11] 4.605
    { 0.958945, 0.957169, 0.955617, 0.953958, 0.952135, 0.950317, 0.948336, 0.946251, 0.944279, 0.941984, 0.939803, 0.937247 }, // [12] 4.967
    { 0.961885, 0.960233, 0.958790, 0.957246, 0.955551, 0.953859, 0.952016, 0.950075, 0.948240, 0.946103, 0.944073, 0.941692 }, // [13] 5.359
    { 0.964618, 0.963082, 0.961740, 0.960305, 0.958728, 0.957154, 0.955440, 0.953634, 0.951926, 0.949938, 0.948048, 0.945832 }, // [14] 5.781
    { 0.967158, 0.965731, 0.964484, 0.963149, 0.961683, 0.960219, 0.958625, 0.956945, 0.955357, 0.953507, 0.951748, 0.949685 }, // [15] 6.236
    { 0.969519, 0.968193, 0.967033, 0.965793, 0.964430, 0.963070, 0.961587, 0.960025, 0.958548, 0.956827, 0.955191, 0.953272 }, // [16] 6.727
    { 0.971713, 0.970480, 0.969403, 0.968250, 0.966984, 0.965719, 0.964341, 0.962889, 0.961515, 0.959915, 0.958393, 0.956608 }, // [17] 7.257
    { 0.973751, 0.972606, 0.971605, 0.970534, 0.969357, 0.968182, 0.966901, 0.965551, 0.964274, 0.962786, 0.961371, 0.959712 }, // [18] 7.829
    { 0.975644, 0.974580, 0.973651, 0.972656, 0.971562, 0.970470, 0.969280, 0.968026, 0.966839, 0.965456, 0.964140, 0.962597 }, // [19] 8.445
    { 0.977402, 0.976414, 0.975551, 0.974626, 0.973611, 0.972596, 0.971491, 0.970325, 0.969222, 0.967937, 0.966714, 0.965280 }, // [20] 9.110
    { 0.979034, 0.978117, 0.977315, 0.976457, 0.975514, 0.974571, 0.973544, 0.972462, 0.971437, 0.970243, 0.969107, 0.967774 }, // [21] 9.828
    { 0.980550, 0.979698, 0.978954, 0.978157, 0.977281, 0.976406, 0.975452, 0.974446, 0.973494, 0.972385, 0.971330, 0.970091 }, // [22] 10.602
    { 0.981957, 0.981167, 0.980475, 0.979735, 0.978922, 0.978109, 0.977224, 0.976290, 0.975406, 0.974375, 0.973395, 0.972244 }, // [23] 11.437
    { 0.983263, 0.982529, 0.981888, 0.981201, 0.980446, 0.979691, 0.978869, 0.978002, 0.977181, 0.976224, 0.975313, 0.974244 }, // [24] 12.338
    { 0.984476, 0.983795, 0.983199, 0.982561, 0.981861, 0.981160, 0.980396, 0.979591, 0.978829, 0.977940, 0.977095, 0.976102 }, // [25] 13.309
    { 0.985601, 0.984969, 0.984416, 0.983824, 0.983174, 0.982523, 0.981815, 0.981067, 0.980359, 0.979534, 0.978749, 0.977827 }, // [26] 14.358
    { 0.986645, 0.986059, 0.985546, 0.984996, 0.984393, 0.983789, 0.983131, 0.982437, 0.981780, 0.981014, 0.980285, 0.979429 }, // [27] 15.488
    { 0.987614, 0.987070, 0.986594, 0.986084, 0.985524, 0.984964, 0.984353, 0.983709, 0.983099, 0.982388, 0.981711, 0.980917 }, // [28] 16.708
    { 0.988513, 0.988008, 0.987567, 0.987094, 0.986574, 0.986054, 0.985487, 0.984889, 0.984323, 0.983663, 0.983035, 0.982298 }, // [29] 18.024
    { 0.989347, 0.988879, 0.988469, 0.988030, 0.987548, 0.987065, 0.986540, 0.985985, 0.985459, 0.984847, 0.984264, 0.983579 }, // [30] 19.444
    { 0.990121, 0.989687, 0.989306, 0.988899, 0.988452, 0.988004, 0.987516, 0.987001, 0.986514, 0.985946, 0.985404, 0.984769 }, // [31] 20.975
    { 0.990839, 0.990436, 0.990083, 0.989706, 0.989290, 0.988875, 0.988422, 0.987945, 0.987492, 0.986965, 0.986463, 0.985873 }, // [32] 22.627
    { 0.991505, 0.991131, 0.990804, 0.990454, 0.990068, 0.989683, 0.989263, 0.988820, 0.988400, 0.987911, 0.987445, 0.986898 }, // [33] 24.410
    { 0.992123, 0.991776, 0.991473, 0.991147, 0.990790, 0.990433, 0.990043, 0.989632, 0.989243, 0.988789, 0.988356, 0.987849 }, // [34] 26.332
    { 0.992696, 0.992374, 0.992093, 0.991791, 0.991460, 0.991128, 0.990767, 0.990385, 0.990024, 0.989603, 0.989202, 0.988731 }, // [35] 28.406
    { 0.993227, 0.992929, 0.992668, 0.992388, 0.992081, 0.991773, 0.991438, 0.991084, 0.990749, 0.990358, 0.989986, 0.989549 }, // [36] 30.643
    { 0.993720, 0.993444, 0.993201, 0.992942, 0.992657, 0.992372, 0.992060, 0.991732, 0.991422, 0.991059, 0.990714, 0.990309 }, // [37] 33.057
    { 0.994177, 0.993921, 0.993696, 0.993456, 0.993191, 0.992926, 0.992638, 0.992334, 0.992045, 0.991709, 0.991389, 0.991013 }, // [38] 35.660
    { 0.994601, 0.994363, 0.994155, 0.993932, 0.993687, 0.993441, 0.993174, 0.992891, 0.992624, 0.992312, 0.992015, 0.991666 }, // [39] 38.469
    { 0.994995, 0.994774, 0.994581, 0.994374, 0.994146, 0.993919, 0.993670, 0.993409, 0.993161, 0.992871, 0.992596, 0.992272 }, // [40] 41.499
    { 0.995359, 0.995154, 0.994975, 0.994783, 0.994572, 0.994361, 0.994131, 0.993888, 0.993658, 0.993390, 0.993135, 0.992835 }, // [41] 44.767
    { 0.995697, 0.995507, 0.995341, 0.995163, 0.994968, 0.994772, 0.994559, 0.994333, 0.994120, 0.993871, 0.993634, 0.993356 }, // [42] 48.293
    { 0.996011, 0.995835, 0.995681, 0.995516, 0.995334, 0.995153, 0.994955, 0.994746, 0.994548, 0.994317, 0.994098, 0.993840 }, // [43] 52.097
    { 0.996302, 0.996138, 0.995995, 0.995842, 0.995674, 0.995506, 0.995322, 0.995129, 0.994945, 0.994731, 0.994527, 0.994288 }, // [44] 56.200
    { 0.996571, 0.996420, 0.996287, 0.996145, 0.995989, 0.995833, 0.995663, 0.995484, 0.995313, 0.995115, 0.994926, 0.994704 }, // [45] 60.626
    { 0.996821, 0.996681, 0.996558, 0.996426, 0.996282, 0.996137, 0.995979, 0.995813, 0.995655, 0.995471, 0.995296, 0.995090 }, // [46] 65.401
    { 0.997053, 0.996923, 0.996809, 0.996687, 0.996553, 0.996418, 0.996272, 0.996118, 0.995971, 0.995801, 0.995638, 0.995447 }, // [47] 70.552
    { 0.997268, 0.997147, 0.997041, 0.996928, 0.996804, 0.996680, 0.996544, 0.996401, 0.996265, 0.996107, 0.995956, 0.995779 }, // [48] 76.109
    { 0.997467, 0.997355, 0.997257, 0.997152, 0.997037, 0.996922, 0.996796, 0.996663, 0.996537, 0.996390, 0.996251, 0.996087 }, // [49] 82.104
    { 0.997652, 0.997548, 0.997457, 0.997360, 0.997253, 0.997146, 0.997029, 0.996906, 0.996790, 0.996654, 0.996524, 0.996372 }, // [50] 88.570
    { 0.997823, 0.997727, 0.997643, 0.997552, 0.997453, 0.997354, 0.997246, 0.997132, 0.997024, 0.996898, 0.996777, 0.996636 }, // [51] 95.546
    { 0.997982, 0.997893, 0.997814, 0.997731, 0.997639, 0.997547, 0.997447, 0.997341, 0.997241, 0.997124, 0.997012, 0.996882 }, // [52] 103.071
    { 0.998129, 0.998046, 0.997974, 0.997896, 0.997811, 0.997726, 0.997633, 0.997535, 0.997442, 0.997333, 0.997230, 0.997109 }, // [53] 111.189
    { 0.998265, 0.998189, 0.998122, 0.998050, 0.997971, 0.997892, 0.997806, 0.997715, 0.997628, 0.997528, 0.997432, 0.997320 }, // [54] 119.947
    { 0.998392, 0.998321, 0.998259, 0.998192, 0.998119, 0.998046, 0.997966, 0.997881, 0.997801, 0.997708, 0.997619, 0.997515 }, // [55] 129.394
    { 0.998509, 0.998443, 0.998386, 0.998324, 0.998256, 0.998188, 0.998114, 0.998036, 0.997962, 0.997875, 0.997793, 0.997696 }, // [56] 139.585
    { 0.998618, 0.998557, 0.998504, 0.998446, 0.998383, 0.998320, 0.998252, 0.998179, 0.998110, 0.998030, 0.997954, 0.997864 }, // [57] 150.579
    { 0.998719, 0.998662, 0.998613, 0.998560, 0.998501, 0.998443, 0.998379, 0.998312, 0.998248, 0.998174, 0.998103, 0.998020 }, // [58] 162.439
    { 0.998812, 0.998760, 0.998714, 0.998665, 0.998611, 0.998556, 0.998497, 0.998435, 0.998376, 0.998307, 0.998242, 0.998165 }, // [59] 175.232
    { 0.998899, 0.998850, 0.998808, 0.998762, 0.998712, 0.998662, 0.998607, 0.998549, 0.998495, 0.998431, 0.998370, 0.998298 }, // [60] 189.034
    { 0.998979, 0.998934, 0.998895, 0.998852, 0.998806, 0.998759, 0.998709, 0.998655, 0.998604, 0.998545, 0.998489, 0.998423 }, // [61] 203.922
    { 0.999054, 0.999012, 0.998975, 0.998936, 0.998893, 0.998850, 0.998803, 0.998753, 0.998706, 0.998651, 0.998599, 0.998538 }, // [62] 219.983
    { 0.999123, 0.999084, 0.999050, 0.999014, 0.998974, 0.998934, 0.998890, 0.998844, 0.998801, 0.998750, 0.998701, 0.998644 }  // [63] 237.309
};

const float lcwInputFilterParams[][5] = {
    // Low-pass
    // fc = 0.0800, Q: 0.707, gain = -3.010(dB)
    {
        /*b0*/  0.046132,
        /*b1*/  0.092264,
        /*b2*/  0.046132,
        /*a1*/ -1.307285,
        /*a2*/  0.491812
    },
    // High-pass
    // fc = 0.0080, Q: 0.707, gain = -3.010(dB)
    {
        /*b0*/  0.965081,
        /*b1*/ -1.930162,
        /*b2*/  0.965081,
        /*a1*/ -1.928942,
        /*a2*/  0.931382
    }
};

const float lcwCombFilterParams[][3] = {
    // fc = 0.216, gain = -0.487(dB)
    { /*b0*/  0.445700, /*b1*/  0.445700, /*a1*/ -0.108599 },
    // fc = 0.212, gain = -0.508(dB)
    { /*b0*/  0.440084, /*b1*/  0.440084, /*a1*/ -0.119831 },
    // fc = 0.209, gain = -0.527(dB)
    { /*b0*/  0.435340, /*b1*/  0.435340, /*a1*/ -0.129321 },
    // fc = 0.206, gain = -0.547(dB)
    { /*b0*/  0.430422, /*b1*/  0.430422, /*a1*/ -0.139156 },
    // fc = 0.203, gain = -0.569(dB)
    { /*b0*/  0.425248, /*b1*/  0.425248, /*a1*/ -0.149504 },
    // fc = 0.200, gain = -0.592(dB)
    { /*b0*/  0.420221, /*b1*/  0.420221, /*a1*/ -0.159558 },
    // fc = 0.196, gain = -0.616(dB)
    { /*b0*/  0.415015, /*b1*/  0.415015, /*a1*/ -0.169970 },
    // fc = 0.193, gain = -0.642(dB)
    { /*b0*/  0.409709, /*b1*/  0.409709, /*a1*/ -0.180582 },
    // fc = 0.190, gain = -0.666(dB)
    { /*b0*/  0.404876, /*b1*/  0.404876, /*a1*/ -0.190248 },
    // fc = 0.187, gain = -0.694(dB)
    { /*b0*/  0.399532, /*b1*/  0.399532, /*a1*/ -0.200936 },
    // fc = 0.184, gain = -0.721(dB)
    { /*b0*/  0.394579, /*b1*/  0.394579, /*a1*/ -0.210842 },
    // fc = 0.180, gain = -0.753(dB)
    { /*b0*/  0.389024, /*b1*/  0.389024, /*a1*/ -0.221951 }
};
