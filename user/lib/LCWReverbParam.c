/*
Copyright 2024 Tomoaki Itoh
This software is released under the MIT License, see LICENSE.txt.
//*/

#include "LCWReverbParam.h"

const int32_t lcwCombDelaySize[LCW_REVERB_COMB_MAX] = {
    1447, 1543, 1627, 1723, 1831, 1949, 2063, 2179
};

const float lcwReverbGainTable[LCW_REVERB_GAIN_TABLE_SIZE][LCW_REVERB_COMB_MAX] = {
    { .0f, .0f, .0f, .0f, .0f, .0f, .0f, .0f }, // [ 0]
// 1447, 1543, 1627, 1723, 1831, 1949, 2063, 2179
    { 0.907993, 0.902198, 0.897157, 0.891430, 0.885032, 0.878093, 0.871441, 0.864725 }, // [ 1] 2.158
    { 0.914414, 0.909002, 0.904293, 0.898941, 0.892958, 0.886467, 0.880240, 0.873949 }, // [ 2] 2.327
    { 0.920407, 0.915356, 0.910960, 0.905961, 0.900370, 0.894301, 0.888476, 0.882588 }, // [ 3] 2.511
    { 0.925997, 0.921286, 0.917183, 0.912517, 0.907295, 0.901625, 0.896180, 0.890673 }, // [ 4] 2.709
    { 0.931210, 0.926817, 0.922991, 0.918637, 0.913763, 0.908468, 0.903381, 0.898234 }, // [ 5] 2.922
    { 0.936068, 0.931974, 0.928407, 0.924346, 0.919800, 0.914857, 0.910108, 0.905300 }, // [ 6] 3.152
    { 0.940594, 0.936780, 0.933456, 0.929671, 0.925431, 0.920821, 0.916388, 0.911900 }, // [ 7] 3.400
    { 0.944809, 0.941257, 0.938160, 0.934634, 0.930682, 0.926383, 0.922249, 0.918061 }, // [ 8] 3.668
    { 0.948734, 0.945427, 0.942543, 0.939258, 0.935576, 0.931569, 0.927715, 0.923809 }, // [ 9] 3.957
    { 0.952386, 0.949309, 0.946624, 0.943565, 0.940136, 0.936403, 0.932811, 0.929170 }, // [10] 4.269
    { 0.955784, 0.952921, 0.950423, 0.947575, 0.944383, 0.940906, 0.937560, 0.934167 }, // [11] 4.605
    { 0.958945, 0.956282, 0.953958, 0.951308, 0.948336, 0.945100, 0.941984, 0.938823 }, // [12] 4.967
    { 0.961885, 0.959408, 0.957246, 0.954782, 0.952016, 0.949004, 0.946103, 0.943160 }, // [13] 5.359
    { 0.964618, 0.962315, 0.960305, 0.958013, 0.955440, 0.952638, 0.949938, 0.947199 }, // [14] 5.781
    { 0.967158, 0.965018, 0.963149, 0.961018, 0.958625, 0.956018, 0.953507, 0.950957 }, // [15] 6.236
    { 0.969519, 0.967530, 0.965793, 0.963812, 0.961587, 0.959163, 0.956827, 0.954455 }, // [16] 6.727
    { 0.971713, 0.969865, 0.968250, 0.966409, 0.964341, 0.962087, 0.959915, 0.957709 }, // [17] 7.257
    { 0.973751, 0.972034, 0.970534, 0.968823, 0.966901, 0.964806, 0.962786, 0.960735 }, // [18] 7.829
    { 0.975644, 0.974049, 0.972656, 0.971066, 0.969280, 0.967333, 0.965456, 0.963549 }, // [19] 8.445
    { 0.977402, 0.975921, 0.974626, 0.973150, 0.971491, 0.969682, 0.967937, 0.966165 }, // [20] 9.110
    { 0.979034, 0.977659, 0.976457, 0.975085, 0.973544, 0.971864, 0.970243, 0.968596 }, // [21] 9.828
    { 0.980550, 0.979273, 0.978157, 0.976883, 0.975452, 0.973891, 0.972385, 0.970855 }, // [22] 10.602
    { 0.981957, 0.980772, 0.979735, 0.978553, 0.977224, 0.975774, 0.974375, 0.972954 }, // [23] 11.437
    { 0.983263, 0.982163, 0.981201, 0.980103, 0.978869, 0.977523, 0.976224, 0.974904 }, // [24] 12.338
    { 0.984476, 0.983454, 0.982561, 0.981542, 0.980396, 0.979146, 0.977940, 0.976714 }, // [25] 13.309
    { 0.985601, 0.984653, 0.983824, 0.982878, 0.981815, 0.980654, 0.979534, 0.978396 }, // [26] 14.358
    { 0.986645, 0.985765, 0.984996, 0.984118, 0.983131, 0.982054, 0.981014, 0.979957 }, // [27] 15.488
    { 0.987614, 0.986798, 0.986084, 0.985269, 0.984353, 0.983353, 0.982388, 0.981407 }, // [28] 16.708
    { 0.988513, 0.987756, 0.987094, 0.986337, 0.985487, 0.984559, 0.983663, 0.982753 }, // [29] 18.024
    { 0.989347, 0.988645, 0.988030, 0.987328, 0.986540, 0.985678, 0.984847, 0.984002 }, // [30] 19.444
    { 0.990121, 0.989469, 0.988899, 0.988248, 0.987516, 0.986717, 0.985946, 0.985161 }, // [31] 20.975
    { 0.990839, 0.990234, 0.989706, 0.989101, 0.988422, 0.987681, 0.986965, 0.986237 }, // [32] 22.627
    { 0.991505, 0.990944, 0.990454, 0.989893, 0.989263, 0.988575, 0.987911, 0.987235 }, // [33] 24.410
    { 0.992123, 0.991603, 0.991147, 0.990628, 0.990043, 0.989405, 0.988789, 0.988162 }, // [34] 26.332
    { 0.992696, 0.992213, 0.991791, 0.991309, 0.990767, 0.990174, 0.989603, 0.989021 }, // [35] 28.406
    { 0.993227, 0.992780, 0.992388, 0.991941, 0.991438, 0.990889, 0.990358, 0.989819 }, // [36] 30.643
    { 0.993720, 0.993305, 0.992942, 0.992527, 0.992060, 0.991551, 0.991059, 0.990559 }, // [37] 33.057
    { 0.994177, 0.993792, 0.993456, 0.993071, 0.992638, 0.992165, 0.991709, 0.991245 }, // [38] 35.660
    { 0.994601, 0.994244, 0.993932, 0.993575, 0.993174, 0.992735, 0.992312, 0.991882 }, // [39] 38.469
    { 0.994995, 0.994663, 0.994374, 0.994043, 0.993670, 0.993264, 0.992871, 0.992472 }, // [40] 41.499
    { 0.995359, 0.995052, 0.994783, 0.994476, 0.994131, 0.993754, 0.993390, 0.993020 }, // [41] 44.767
    { 0.995697, 0.995412, 0.995163, 0.994879, 0.994559, 0.994209, 0.993871, 0.993528 }, // [42] 48.293
    { 0.996011, 0.995747, 0.995516, 0.995252, 0.994955, 0.994631, 0.994317, 0.993999 }, // [43] 52.097
    { 0.996302, 0.996057, 0.995842, 0.995598, 0.995322, 0.995022, 0.994731, 0.994436 }, // [44] 56.200
    { 0.996571, 0.996344, 0.996145, 0.995918, 0.995663, 0.995384, 0.995115, 0.994841 }, // [45] 60.626
    { 0.996821, 0.996610, 0.996426, 0.996216, 0.995979, 0.995721, 0.995471, 0.995217 }, // [46] 65.401
    { 0.997053, 0.996858, 0.996687, 0.996492, 0.996272, 0.996032, 0.995801, 0.995565 }, // [47] 70.552
    { 0.997268, 0.997087, 0.996928, 0.996747, 0.996544, 0.996322, 0.996107, 0.995888 }, // [48] 76.109
    { 0.997467, 0.997299, 0.997152, 0.996984, 0.996796, 0.996590, 0.996390, 0.996188 }, // [49] 82.104
    { 0.997652, 0.997496, 0.997360, 0.997204, 0.997029, 0.996838, 0.996654, 0.996466 }, // [50] 88.570
    { 0.997823, 0.997679, 0.997552, 0.997408, 0.997246, 0.997069, 0.996898, 0.996723 }, // [51] 95.546
    { 0.997982, 0.997848, 0.997731, 0.997597, 0.997447, 0.997282, 0.997124, 0.996962 }, // [52] 103.071
    { 0.998129, 0.998005, 0.997896, 0.997772, 0.997633, 0.997481, 0.997333, 0.997184 }, // [53] 111.189
    { 0.998265, 0.998150, 0.998050, 0.997935, 0.997806, 0.997664, 0.997528, 0.997389 }, // [54] 119.947
    { 0.998392, 0.998285, 0.998192, 0.998086, 0.997966, 0.997835, 0.997708, 0.997579 }, // [55] 129.394
    { 0.998509, 0.998410, 0.998324, 0.998225, 0.998114, 0.997993, 0.997875, 0.997756 }, // [56] 139.585
    { 0.998618, 0.998526, 0.998446, 0.998355, 0.998252, 0.998139, 0.998030, 0.997920 }, // [57] 150.579
    { 0.998719, 0.998634, 0.998560, 0.998475, 0.998379, 0.998275, 0.998174, 0.998071 }, // [58] 162.439
    { 0.998812, 0.998734, 0.998665, 0.998586, 0.998497, 0.998401, 0.998307, 0.998212 }, // [59] 175.232
    { 0.998899, 0.998826, 0.998762, 0.998689, 0.998607, 0.998517, 0.998431, 0.998343 }, // [60] 189.034
    { 0.998979, 0.998912, 0.998852, 0.998785, 0.998709, 0.998626, 0.998545, 0.998463 }, // [61] 203.922
    { 0.999054, 0.998991, 0.998936, 0.998873, 0.998803, 0.998726, 0.998651, 0.998576 }, // [62] 219.983
    { 0.999123, 0.999065, 0.999014, 0.998956, 0.998890, 0.998819, 0.998750, 0.998679 }  // [63] 237.309
};

const float lcwInputFilterParams[][5] = {
    // Low-pass
    // fc = 0.0800, Q: 0.707, gain = -3.010(dB)
    {
        /*b0*/  0.046132,
        /*b1*/  0.092264,
        /*b2*/  0.046132,
        /*a1*/ -1.307285,
        /*a2*/  0.491812
    },
    // High-pass
    // fc = 0.0080, Q: 0.707, gain = -3.010(dB)
    {
        /*b0*/  0.965081,
        /*b1*/ -1.930162,
        /*b2*/  0.965081,
        /*a1*/ -1.928942,
        /*a2*/  0.931382
    }
};

const float lcwCombFilterParams[][3] = {
    // fc = 0.213, gain = -0.500(dB)
    { /*b0*/  0.442252, /*b1*/  0.442252, /*a1*/ -0.115496 },
    // fc = 0.208, gain = -0.533(dB)
    { /*b0*/  0.433890, /*b1*/  0.433890, /*a1*/ -0.132220 },
    // fc = 0.204, gain = -0.562(dB)
    { /*b0*/  0.427028, /*b1*/  0.427028, /*a1*/ -0.145944 },
    // fc = 0.199, gain = -0.595(dB)
    { /*b0*/  0.419490, /*b1*/  0.419490, /*a1*/ -0.161021 },
    // fc = 0.194, gain = -0.632(dB)
    { /*b0*/  0.411589, /*b1*/  0.411589, /*a1*/ -0.176822 },
    // fc = 0.189, gain = -0.673(dB)
    { /*b0*/  0.403481, /*b1*/  0.403481, /*a1*/ -0.193039 },
    // fc = 0.185, gain = -0.713(dB)
    { /*b0*/  0.396067, /*b1*/  0.396067, /*a1*/ -0.207866 },
    // fc = 0.180, gain = -0.753(dB)
    { /*b0*/  0.389024, /*b1*/  0.389024, /*a1*/ -0.221951 }
};
